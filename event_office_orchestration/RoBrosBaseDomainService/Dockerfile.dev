FROM mcr.microsoft.com/dotnet/sdk:9.0
WORKDIR /app

# Install dotnet-ef for migrations
RUN dotnet tool install --global dotnet-ef
ENV PATH="${PATH}:/root/.dotnet/tools"

# Copy project file
COPY ["RoBrosBaseDomainService.csproj", "./"]

# Restore dependencies
RUN dotnet restore "RoBrosBaseDomainService.csproj"

# Enable hot reload
ENV DOTNET_USE_POLLING_FILE_WATCHER=true
ENV ASPNETCORE_ENVIRONMENT=Development

# Expose port
EXPOSE 5000

# The actual source code will be mounted as a volume
# Command is defined in docker-compose.dev.yml